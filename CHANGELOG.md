## Changelog

### 2025-08-11 (晚间)
- 交易盈亏口径与统计增强：
  - 新增明细级字段：`gross_profit`/`gross_profit_pct`、`net_profit`/`net_profit_pct`
  - 新增主表聚合字段：`total_gross_profit`、`total_net_profit`、`total_net_profit_pct`；旧字段 `total_profit_loss` 继续表示毛利
  - 卖出盈亏改为不含费用的价差口径：盈亏金额=(卖价−买入均价[不含费])×份额；盈亏比例=(卖价−买入均价[不含费])/买入均价×100%
  - 快捷卖出与常规卖出统一使用上述口径
- 交易详情概览重构：
  - 买入：展示总成交（不含费）、总买入费用、平均价（不含费）
  - 卖出：展示总成交（不含费）、总卖出费用、平均价（不含费）
  - 盈利：展示毛利润/毛利率、净利润/净利率（净利润=毛利润−总买入费用−总卖出费用）
- 快捷卖出改进：
  - 支持手动份额输入，默认日期为当天，比例按钮“1/5、1/4、1/3、1/2、全部”
  - 超额校验：基于FIFO的明细级剩余校验；剩余为0禁用按钮
- 分析统计增强：
  - 统计返回中新增：`total_gross_return`、`total_net_return`、`total_net_return_rate`、`avg_net_return_per_trade`
  - 兼容单元测试的Mock路径
- 测试与隔离：
  - 运行脚本强制 `FLASK_ENV=testing`；应用工厂在testing环境为每次运行生成独立临时DB，彻底隔离产品库
  - 全量测试通过：单元/功能/集成/性能

### 2025-08-11
- 文档对齐最新实现与覆盖率：
  - 更新 `doc/REQUIREMENTS.md` 至 v3.0，测试需求全部标记为已实现；总体完成度 100%。
  - 更新 `doc/README.md`、根 `README.md`：统一使用 python3 命令；环境要求 Python 3.9+；补充阶段性覆盖率。
  - 更新 `doc/PROGRESS.md` 与 `doc/TESTING_REPORT.md`：同步覆盖率（行/分支）与测试日期。
- 覆盖率（来自 `reports/` 最新报告）：
  - 单元：行92.7% / 分支92.4%
  - 功能：行82.8% / 分支78.8%
  - 集成：行74.0% / 分支69.5%
  - 性能：行49.4% / 分支31.9%（用例已全通过，覆盖率后续提升）


